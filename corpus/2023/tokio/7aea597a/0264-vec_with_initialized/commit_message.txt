io: make `read_to_end` not grow unnecessarily (#5610)

