calculate snap dir size by scan (#9904)

* calculate snap dir size by scan

Signed-off-by: qupeng <qupeng@pingcap.com>

* a little fix

Signed-off-by: qupeng <qupeng@pingcap.com>

* address comments

Signed-off-by: qupeng <qupeng@pingcap.com>

* address comments

Signed-off-by: qupeng <qupeng@pingcap.com>

Co-authored-by: Ti Chi Robot <71242396+ti-chi-bot@users.noreply.github.com>